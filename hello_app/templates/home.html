{% extends "layout.html" %}
{% block title %}
Weather History Tracker - Homepage
{% endblock %}
{% block content %}


<div class="container">
    <h1>Weather History Tracker</h1>
    </p>Welcome to the UK Weather History Tracker. This website allows you to view historical weather data from across the UK based on:</p>
    <ul>
        <li>Rainfall</li>
        <li>Temperature</li>
        <li>Wind Speed</li>
        <li>Sunrise and sunset</li>
    </ul>
    <form method="get" action="/">
      <label>Latitude: <input type="text" name="latitude" value="{{ request.args.get('latitude', '51.5') }}"></label>
      <label>Longitude: <input type="text" name="longitude" value="{{ request.args.get('longitude', '-0.12') }}"></label>
      <label>Start Date: <input type="date" name="start_date" value="{{ request.args.get('start_date', '2025-03-01') }}"></label>
      <label>End Date: <input type="date" name="end_date" value="{{ request.args.get('end_date', '2025-04-01') }}"></label>
      <button type="submit">Get Weather</button>
    </form>

    {% if api_data %}
        <div>
            <h3>Daily Weather Data</h3>
            <table border="1" style="border-collapse:collapse;max-width:100%;">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Max Temp (°C)</th>
                        <th>Min Temp (°C)</th>
                        <th>Max Wind Speed (km/h)</th>
                        <th>Rain (mm)</th>
                        <th>Sunrise</th>
                        <th>Sunset</th>
                    </tr>
                </thead>
                <tbody>
                    {% for day in api_data %}
                        <tr>
                            <td>{{ day.time }}</td>
                            <td>{{ day.temperature_2m_max }}</td>
                            <td>{{ day.temperature_2m_min }}</td>
                            <td>{{ day.wind_speed_10m_max }}</td>
                            <td>{{ day.rain_sum }}</td>
                            <td>{{ day.sunrise.split('T')[1][:5] if day.sunrise and 'T' in day.sunrise else day.sunrise[:5].replace(':', '/') if day.sunrise }}</td>
                            <td>{{ day.sunset.split('T')[1][:5] if day.sunset and 'T' in day.sunset else day.sunset[:5].replace(':', '/') if day.sunset }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}
</div>

 {% endblock %}